<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HydraLearn STEM: Cánh Tay Robot Thủy Lực</title>
    
    <!-- 1. Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- 2. React & ReactDOM (UMD) -->
    <script crossorigin src="https://unpkg.com/react@18.2.0/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
    
    <!-- 3. Babel Standalone -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }
        
        /* Animation */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fadeIn { animation: fadeIn 0.4s ease-out forwards; }

        /* Print Styles */
        @media print {
            @page { margin: 1cm; size: A4; }
            body { background-color: white !important; -webkit-print-color-adjust: exact; }
            .no-print { display: none !important; }
            .print-only { display: block !important; }
            .print-border { border: 1px solid #ddd !important; }
            .shadow-lg, .shadow-md, .shadow-sm { box-shadow: none !important; }
            .bg-indigo-600, .bg-teal-600, .bg-blue-600, .bg-purple-600 { background-color: transparent !important; color: black !important; border: 1px solid #000; }
            input, select, textarea { border: none !important; border-bottom: 1px dotted #000 !important; }
        }
        .print-only { display: none; }
    </style>
<script type="importmap">
{
  "imports": {
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.30.0",
    "react": "https://aistudiocdn.com/react@^19.2.0",
    "lucide-react": "https://aistudiocdn.com/lucide-react@^0.554.0",
    "react/": "https://aistudiocdn.com/react@^19.2.0/"
  }
}
</script>
</head>
<body>
    <div id="root"></div>

    <!-- MAIN APP SCRIPT -->
    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- ICONS (Embedded SVGs to fix "?" error) ---
        const IconBase = ({ size = 24, className = "", children }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                {children}
            </svg>
        );

        const BookOpen = (p) => <IconBase {...p}><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></IconBase>;
        const Cog = (p) => <IconBase {...p}><path d="M12 20a8 8 0 1 0 0-16 8 8 0 0 0 0 16Z"/><path d="M12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z"/><path d="M12 2v2"/><path d="M12 22v-2"/><path d="m17 20.66-1-1.73"/><path d="M11 10.27 7 3.34"/><path d="m20.66 17-1.73-1"/><path d="m3.34 7 1.73 1"/><path d="M14 12h8"/><path d="M2 12h2"/><path d="m20.66 7-1.73 1"/><path d="m3.34 17 1.73-1"/><path d="m17 3.34-1 1.73"/><path d="m11 13.73-4 6.93"/></IconBase>;
        const FileText = (p) => <IconBase {...p}><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" x2="8" y1="13" y2="13"/><line x1="16" x2="8" y1="17" y2="17"/><polyline points="10 9 9 9 8 9"/></IconBase>;
        const Printer = (p) => <IconBase {...p}><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect width="12" height="8" x="6" y="14"/></IconBase>;
        const Beaker = (p) => <IconBase {...p}><path d="M4.5 3h15"/><path d="M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3"/><path d="M6 14h12"/></IconBase>;
        const ChevronRight = (p) => <IconBase {...p}><path d="m9 18 6-6-6-6"/></IconBase>;
        const Check = (p) => <IconBase {...p}><polyline points="20 6 9 17 4 12"/></IconBase>;
        const X = (p) => <IconBase {...p}><path d="M18 6 6 18"/><path d="m6 6 18 12"/></IconBase>;
        const AlertTriangle = (p) => <IconBase {...p}><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><line x1="12" x2="12" y1="9" y2="13"/><line x1="12" x2="12.01" y1="17" y2="17"/></IconBase>;
        const RotateCw = (p) => <IconBase {...p}><path d="M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/></IconBase>;
        const ArrowUpFromLine = (p) => <IconBase {...p}><path d="m18 9-6-6-6 6"/><path d="M12 3v14"/><path d="M5 21h14"/></IconBase>;
        const Grip = (p) => <IconBase {...p}><circle cx="12" cy="5" r="1"/><circle cx="19" cy="5" r="1"/><circle cx="5" cy="5" r="1"/><circle cx="12" cy="12" r="1"/><circle cx="19" cy="12" r="1"/><circle cx="5" cy="12" r="1"/><circle cx="12" cy="19" r="1"/><circle cx="19" cy="19" r="1"/><circle cx="5" cy="19" r="1"/></IconBase>;
        const RefreshCw = (p) => <IconBase {...p}><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/></IconBase>;
        const Save = (p) => <IconBase {...p}><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></IconBase>;
        const Calculator = (p) => <IconBase {...p}><rect width="16" height="20" x="4" y="2" rx="2"/><line x1="8" x2="16" y1="6" y2="6"/><line x1="16" x2="16" y1="14" y2="18"/><path d="M16 10h.01"/><path d="M12 10h.01"/><path d="M8 10h.01"/><path d="M12 14h.01"/><path d="M8 14h.01"/><path d="M12 18h.01"/><path d="M8 18h.01"/></IconBase>;

        // --- CONSTANTS ---
        const STEPS = {
            INTRO: 'INTRO',
            PASCAL: 'PASCAL',
            MECHANICS: 'MECHANICS',
            DESIGN: 'DESIGN',
            SUMMARY: 'SUMMARY'
        };

        // --- COMPONENTS ---

        // 1. PASCAL MODULE
        const PascalModule = () => {
            const [f1, setF1] = useState(10);
            const [s1, setS1] = useState(2);
            const [s2, setS2] = useState(10);
            const [f2, setF2] = useState(0);
            const [ans, setAns] = useState('');
            const [res, setRes] = useState(null);

            useEffect(() => {
                if (s1 > 0) setF2(parseFloat((f1 * (s2 / s1)).toFixed(2)));
            }, [f1, s1, s2]);

            const check = () => {
                setRes(parseFloat(ans) === 5 ? 'ok' : 'no');
            };

            return (
                <div className="space-y-6 animate-fadeIn">
                    <div className="bg-white p-6 rounded-lg shadow-sm border-l-4 border-blue-500">
                        <h2 className="text-xl font-bold text-blue-800 mb-2">1. Nguyên lý Pascal</h2>
                        <p className="text-gray-600 mb-4">"Áp suất tác dụng lên chất lỏng kín được truyền đi nguyên vẹn theo mọi hướng."</p>
                        <div className="bg-blue-50 p-4 rounded text-center font-mono text-blue-900 font-bold">
                            F₂ = F₁ × (S₂ / S₁)
                        </div>
                    </div>

                    <div className="grid md:grid-cols-2 gap-6">
                        <div className="bg-white p-6 rounded-lg shadow-sm">
                            <h3 className="font-bold mb-4 flex items-center"><Calculator size={20} className="mr-2 text-blue-500"/> Tính toán</h3>
                            <div className="space-y-3">
                                <div><label className="block text-sm text-gray-500">Lực F1 (Newton)</label><input type="number" value={f1} onChange={e=>setF1(Number(e.target.value))} className="w-full border p-2 rounded focus:ring-2 focus:ring-blue-200 outline-none"/></div>
                                <div className="grid grid-cols-2 gap-2">
                                    <div><label className="block text-sm text-gray-500">Diện tích S1 (cm²)</label><input type="number" value={s1} onChange={e=>setS1(Number(e.target.value))} className="w-full border p-2 rounded focus:ring-2 focus:ring-blue-200 outline-none"/></div>
                                    <div><label className="block text-sm text-gray-500">Diện tích S2 (cm²)</label><input type="number" value={s2} onChange={e=>setS2(Number(e.target.value))} className="w-full border p-2 rounded focus:ring-2 focus:ring-blue-200 outline-none"/></div>
                                </div>
                            </div>
                        </div>

                        <div className="bg-gradient-to-br from-blue-500 to-indigo-600 text-white p-6 rounded-lg shadow-md flex flex-col justify-center items-center">
                            <div className="text-lg opacity-80">Lực đầu ra F2</div>
                            <div className="text-4xl font-bold my-2">{f2} N</div>
                            <div className="text-sm bg-white/20 px-3 py-1 rounded-full">Khuếch đại: {(s2/s1).toFixed(1)} lần</div>
                        </div>
                    </div>

                    <div className="bg-yellow-50 p-6 rounded-lg border border-yellow-200">
                        <h3 className="font-bold text-yellow-800 mb-2 flex items-center"><AlertTriangle size={18} className="mr-2"/> Thử thách</h3>
                        <p className="mb-3 text-sm">Để nâng vật <b>500 gram</b> bằng lực ấn tương đương <b>100 gram</b>, bạn cần tỉ lệ diện tích Piston lớn so với Piston nhỏ (S₂/S₁) tối thiểu là bao nhiêu?</p>
                        <div className="flex gap-2">
                            <input type="number" value={ans} onChange={e => {setAns(e.target.value); setRes(null)}} placeholder="Nhập số..." className="border p-2 rounded w-32 focus:ring-2 focus:ring-yellow-200 outline-none"/>
                            <button onClick={check} className="bg-yellow-600 text-white px-4 rounded hover:bg-yellow-700 transition-colors">Kiểm tra</button>
                        </div>
                        {res === 'ok' && <div className="text-green-600 font-bold mt-2 flex items-center"><Check size={16} className="mr-1"/> Chính xác! (5 lần)</div>}
                        {res === 'no' && <div className="text-red-500 font-bold mt-2 flex items-center"><X size={16} className="mr-1"/> Sai rồi. Gợi ý: 500 chia 100.</div>}
                    </div>
                </div>
            );
        };

        // 2. MECHANICS MODULE
        const MechanicsModule = () => {
            // Logic cho bài tập khớp nối
            const [matches, setMatches] = useState({});
            const joints = [
                {id: 'base', name: 'Khớp Xoay (Đế)', icon: <RotateCw size={20}/>},
                {id: 'arm', name: 'Khớp Nâng (Vai)', icon: <ArrowUpFromLine size={20}/>},
                {id: 'claw', name: 'Khớp Kẹp', icon: <Grip size={20}/>}
            ];

            const onDrop = (e, target) => {
                e.preventDefault();
                const id = e.dataTransfer.getData("id");
                setMatches(prev => ({...prev, [target]: id}));
            };

            // Logic cho vật liệu
            const [mat, setMat] = useState({cung: '', re: '', de: ''});
            const [checkMat, setCheckMat] = useState(false);

            const feedback = (type, val) => {
                if (!checkMat || !val) return null;
                let msg = "", ok = false;
                
                if (type === 'cung') {
                    if (val === 'formex') { ok = true; msg = "Đúng! Formex rất cứng và chịu nước."; }
                    else if (val === 'bia') { ok = true; msg = "Đúng! Tuy mềm hơn, nhưng nếu dán nhiều lớp (Carton lạnh) thì vẫn đủ cứng và tốt cho môi trường."; }
                    else msg = "Que kem hơi mảnh khảnh để làm khung chịu lực lớn.";
                }
                if (type === 're') {
                    if (val === 'bia') { ok = true; msg = "Chính xác! Tận dụng bìa cũ là rẻ nhất."; }
                    else msg = "Chưa tối ưu chi phí bằng bìa carton.";
                }
                if (type === 'de') {
                    if (val === 'bia') { ok = true; msg = "Đúng! Dễ cắt bằng kéo thường."; }
                    else if (val === 'formex') { ok = true; msg = "Đúng! Cắt bằng dao rọc giấy khá dễ."; }
                    else msg = "Que kem cứng, khó cắt đẹp nếu không có kìm bấm.";
                }

                return (
                    <div className={`mt-1 text-xs p-2 rounded flex items-start ${ok ? 'bg-green-100 text-green-800' : 'bg-orange-100 text-orange-800'}`}>
                        <div className="mt-0.5 mr-1 flex-shrink-0">{ok ? <Check size={14}/> : <AlertTriangle size={14}/>}</div>
                        <span>{msg}</span>
                    </div>
                );
            };

            const MatSelect = ({type, val, set}) => (
                <div className="mb-4">
                    <select value={val} onChange={e => {set(e.target.value); setCheckMat(false)}} className="w-full border p-2 rounded bg-gray-50 focus:ring-2 focus:ring-purple-200 outline-none">
                        <option value="">-- Chọn vật liệu --</option>
                        <option value="bia">Bìa Carton cứng</option>
                        <option value="que">Que kem</option>
                        <option value="formex">Bìa Formex (Nhựa xốp)</option>
                    </select>
                    {feedback(type, val)}
                </div>
            );

            return (
                <div className="space-y-8 animate-fadeIn">
                    <div className="bg-white p-6 rounded-lg shadow-sm border-l-4 border-purple-500">
                        <h2 className="text-xl font-bold text-purple-800 mb-4">2. Cơ khí & Vật liệu</h2>
                        
                        {/* Bài tập Khớp */}
                        <div className="mb-8">
                            <h3 className="font-bold text-gray-700 mb-2">HĐ 1: Ghép nối khớp (Kéo thả)</h3>
                            <div className="grid md:grid-cols-2 gap-4">
                                <div className="space-y-2">
                                    {joints.map(j => (
                                        <div key={j.id} draggable onDragStart={e => e.dataTransfer.setData("id", j.id)} className="bg-purple-50 p-3 rounded border border-purple-200 cursor-move flex items-center gap-2 hover:bg-purple-100 transition-colors">
                                            {j.icon} {j.name}
                                        </div>
                                    ))}
                                </div>
                                <div className="space-y-2">
                                    {['base', 'arm', 'claw'].map(key => (
                                        <div key={key} onDragOver={e=>e.preventDefault()} onDrop={e=>onDrop(e, key)} className={`h-12 border-2 border-dashed rounded flex items-center justify-center transition-colors ${matches[key] === key ? 'border-green-500 bg-green-50 text-green-700 font-bold' : 'border-gray-300 text-gray-400'}`}>
                                            {matches[key] === key ? <><Check size={18} className="mr-2"/> Chính xác!</> : (key === 'base' ? 'Thả khớp quay đế vào đây' : key === 'arm' ? 'Thả khớp nâng tay vào đây' : 'Thả khớp kẹp vào đây')}
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>

                        {/* Bài tập Vật liệu */}
                        <div className="border-t pt-6">
                            <h3 className="font-bold text-gray-700 mb-4">HĐ 2: Lựa chọn vật liệu</h3>
                            <div className="grid md:grid-cols-3 gap-4">
                                <div>
                                    <label className="text-sm font-semibold block mb-1 text-gray-600">Độ cứng cao nhất</label>
                                    <MatSelect type="cung" val={mat.cung} set={v => setMat({...mat, cung: v})} />
                                </div>
                                <div>
                                    <label className="text-sm font-semibold block mb-1 text-gray-600">Chi phí thấp nhất</label>
                                    <MatSelect type="re" val={mat.re} set={v => setMat({...mat, re: v})} />
                                </div>
                                <div>
                                    <label className="text-sm font-semibold block mb-1 text-gray-600">Dễ gia công nhất</label>
                                    <MatSelect type="de" val={mat.de} set={v => setMat({...mat, de: v})} />
                                </div>
                            </div>
                            <button onClick={() => setCheckMat(true)} className="mt-2 bg-purple-600 text-white px-4 py-2 rounded text-sm hover:bg-purple-700 flex items-center transition-colors shadow">
                                <RefreshCw size={16} className="mr-2"/> Kiểm tra / Thử lại
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        // 3. DESIGN FORM
        const DesignForm = ({ onFinish }) => {
            const [data, setData] = useState({ s1: '', s2: '', mat: 'bia', khop: '3', note: '' });

            return (
                <div className="animate-fadeIn bg-white p-8 rounded-lg shadow-lg border-t-4 border-teal-500 max-w-2xl mx-auto">
                    <h2 className="text-2xl font-bold text-teal-800 mb-6 flex items-center"><FileText size={28} className="mr-2"/> Phiếu Đề Xuất Thiết Kế</h2>
                    <div className="space-y-4">
                        <div className="bg-teal-50 p-4 rounded border border-teal-100">
                            <h3 className="font-bold text-teal-800 mb-2">1. Hệ thống thủy lực (mm)</h3>
                            <div className="grid grid-cols-2 gap-4">
                                <div><label className="text-xs text-gray-600 font-semibold uppercase">Xilanh Điều khiển (S1)</label><input type="number" className="w-full border p-2 rounded mt-1 focus:ring-2 focus:ring-teal-200 outline-none" value={data.s1} onChange={e=>setData({...data, s1: e.target.value})} placeholder="VD: 10"/></div>
                                <div><label className="text-xs text-gray-600 font-semibold uppercase">Xilanh Chấp hành (S2)</label><input type="number" className="w-full border p-2 rounded mt-1 focus:ring-2 focus:ring-teal-200 outline-none" value={data.s2} onChange={e=>setData({...data, s2: e.target.value})} placeholder="VD: 20"/></div>
                            </div>
                        </div>
                        <div>
                            <label className="font-semibold text-sm text-gray-700">2. Vật liệu khung chính</label>
                            <select className="w-full border p-2 rounded mt-1 focus:ring-2 focus:ring-teal-200 outline-none" value={data.mat} onChange={e=>setData({...data, mat: e.target.value})}>
                                <option value="bia">Bìa Carton cứng / Carton lạnh (Khuyên dùng)</option>
                                <option value="formex">Bìa Formex</option>
                                <option value="que">Que kem</option>
                                <option value="hon_hop">Hỗn hợp</option>
                            </select>
                        </div>
                        <div>
                            <label className="font-semibold text-sm text-gray-700">3. Số khớp chuyển động</label>
                            <select className="w-full border p-2 rounded mt-1 focus:ring-2 focus:ring-teal-200 outline-none" value={data.khop} onChange={e=>setData({...data, khop: e.target.value})}>
                                <option value="3">3 Khớp (Xoay, Nâng, Kẹp)</option>
                                <option value="4">4 Khớp (Thêm khuỷu tay)</option>
                                <option value="2">2 Khớp (Đơn giản)</option>
                            </select>
                        </div>
                        <div>
                            <label className="font-semibold text-sm text-gray-700">4. Ghi chú thêm</label>
                            <textarea className="w-full border p-2 rounded mt-1 focus:ring-2 focus:ring-teal-200 outline-none" rows="3" value={data.note} onChange={e=>setData({...data, note: e.target.value})} placeholder="Ý tưởng sáng tạo khác..."></textarea>
                        </div>
                        <button onClick={() => onFinish(data)} className="w-full bg-teal-600 text-white py-3 rounded-lg font-bold hover:bg-teal-700 flex justify-center items-center transition-colors shadow-md mt-4">
                            <Save size={20} className="mr-2"/> Hoàn thành Đề xuất
                        </button>
                    </div>
                </div>
            );
        };

        // 4. MAIN APP CONTAINER
        const App = () => {
            const [step, setStep] = useState(STEPS.INTRO);
            const [report, setReport] = useState(null);

            const finishDesign = (data) => {
                setReport(data);
                setStep(STEPS.SUMMARY);
            };

            const renderContent = () => {
                switch(step) {
                    case STEPS.INTRO: return (
                        <div className="text-center py-10 animate-fadeIn max-w-3xl mx-auto mt-10">
                            <div className="bg-white p-12 rounded-2xl shadow-xl border border-gray-100">
                                <h1 className="text-4xl font-bold text-indigo-800 mb-6">Cánh Tay Robot Thủy Lực</h1>
                                <p className="text-gray-600 mb-10 text-lg">Hoạt động STEM (Lớp 8):<br/>Nghiên cứu kiến thức nền & Đề xuất giải pháp thiết kế</p>
                                <button onClick={() => setStep(STEPS.PASCAL)} className="bg-indigo-600 text-white px-10 py-4 rounded-full font-bold shadow-lg hover:bg-indigo-700 hover:shadow-xl transition-all flex items-center mx-auto text-xl">
                                    Bắt đầu bài học <ChevronRight size={24} className="ml-2"/>
                                </button>
                            </div>
                        </div>
                    );
                    case STEPS.PASCAL: return <PascalModule />;
                    case STEPS.MECHANICS: return <MechanicsModule />;
                    case STEPS.DESIGN: return <DesignForm onFinish={finishDesign} />;
                    case STEPS.SUMMARY: return (
                        <div className="max-w-2xl mx-auto bg-white p-10 rounded-xl shadow-lg animate-fadeIn print-border mt-6">
                            <div className="text-center border-b pb-4 mb-6">
                                <h2 className="text-3xl font-bold text-gray-800 uppercase">Phiếu Đề Xuất Thiết Kế</h2>
                                <p className="text-gray-500 mt-1">Dự án STEM: Robot xử lý rác thải</p>
                            </div>
                            <div className="space-y-6 mb-8 text-left">
                                <div className="grid grid-cols-2 gap-6 border-b pb-6">
                                    <div><span className="text-gray-500 text-xs uppercase font-bold tracking-wider block mb-1">Xilanh S1 (Điều khiển)</span> <b className="text-xl text-gray-800">{report.s1 || "_"} mm</b></div>
                                    <div><span className="text-gray-500 text-xs uppercase font-bold tracking-wider block mb-1">Xilanh S2 (Chấp hành)</span> <b className="text-xl text-gray-800">{report.s2 || "_"} mm</b></div>
                                </div>
                                <div className="grid grid-cols-2 gap-6 border-b pb-6">
                                    <div><span className="text-gray-500 text-xs uppercase font-bold tracking-wider block mb-1">Vật liệu khung</span> <b className="text-gray-800">{report.mat === 'bia' ? 'Bìa Carton cứng' : report.mat === 'formex' ? 'Bìa Formex' : report.mat === 'que' ? 'Que kem' : 'Hỗn hợp'}</b></div>
                                    <div><span className="text-gray-500 text-xs uppercase font-bold tracking-wider block mb-1">Số khớp</span> <b className="text-gray-800">{report.khop} Khớp</b></div>
                                </div>
                                <div><span className="text-gray-500 text-xs uppercase font-bold tracking-wider block mb-1">Ghi chú</span> <p className="italic text-gray-700 bg-gray-50 p-3 rounded">{report.note || "Không có ghi chú thêm."}</p></div>
                            </div>
                            <div className="flex justify-center gap-4 no-print">
                                <button onClick={() => window.print()} className="bg-blue-600 text-white px-6 py-3 rounded-lg shadow hover:bg-blue-700 flex items-center font-bold transition-colors">
                                    <Printer size={20} className="mr-2"/> Lưu PDF / In Phiếu
                                </button>
                                <button onClick={() => setStep(STEPS.INTRO)} className="bg-gray-100 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-200 transition-colors font-medium">Làm lại</button>
                            </div>
                            <div className="print-only text-center text-xs text-gray-400 mt-10 border-t pt-2">HydraLearn App - Được tạo lúc: {new Date().toLocaleDateString()} {new Date().toLocaleTimeString()}</div>
                        </div>
                    );
                    default: return null;
                }
            };

            return (
                <div className="min-h-screen flex flex-col font-sans text-gray-900">
                    {/* Header */}
                    <header className="bg-white shadow-sm h-16 flex items-center px-4 sticky top-0 z-50 no-print">
                        <div className="max-w-5xl w-full mx-auto flex justify-between items-center">
                            <div className="font-bold text-indigo-700 text-xl flex items-center gap-2"><Beaker className="text-indigo-600"/> HydraLearn</div>
                            {step !== STEPS.INTRO && (
                                <nav className="hidden md:flex bg-gray-100 p-1 rounded-lg gap-1">
                                    <button onClick={() => setStep(STEPS.PASCAL)} className={`px-4 py-1.5 rounded-md text-sm font-medium transition-all ${step===STEPS.PASCAL ? 'bg-white shadow text-indigo-700' : 'text-gray-500 hover:bg-gray-200'}`}>1. Pascal</button>
                                    <button onClick={() => setStep(STEPS.MECHANICS)} className={`px-4 py-1.5 rounded-md text-sm font-medium transition-all ${step===STEPS.MECHANICS ? 'bg-white shadow text-indigo-700' : 'text-gray-500 hover:bg-gray-200'}`}>2. Cơ khí</button>
                                    <button onClick={() => setStep(STEPS.DESIGN)} className={`px-4 py-1.5 rounded-md text-sm font-medium transition-all ${step===STEPS.DESIGN ? 'bg-white shadow text-indigo-700' : 'text-gray-500 hover:bg-gray-200'}`}>3. Thiết kế</button>
                                </nav>
                            )}
                        </div>
                    </header>

                    {/* Content */}
                    <main className="flex-grow p-4 md:p-8 max-w-5xl w-full mx-auto">
                        {renderContent()}
                    </main>

                    {/* Mobile Nav */}
                    <div className="md:hidden fixed bottom-0 w-full bg-white border-t flex justify-around p-3 no-print z-40 pb-safe">
                        <button onClick={() => setStep(STEPS.PASCAL)} className={`p-2 rounded flex flex-col items-center ${step===STEPS.PASCAL?'text-indigo-600 bg-indigo-50':'text-gray-400'}`}><BookOpen size={20}/><span className="text-[10px] font-bold mt-1">Pascal</span></button>
                        <button onClick={() => setStep(STEPS.MECHANICS)} className={`p-2 rounded flex flex-col items-center ${step===STEPS.MECHANICS?'text-indigo-600 bg-indigo-50':'text-gray-400'}`}><Cog size={20}/><span className="text-[10px] font-bold mt-1">Cơ khí</span></button>
                        <button onClick={() => setStep(STEPS.DESIGN)} className={`p-2 rounded flex flex-col items-center ${step===STEPS.DESIGN?'text-indigo-600 bg-indigo-50':'text-gray-400'}`}><FileText size={20}/><span className="text-[10px] font-bold mt-1">Thiết kế</span></button>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>